(function(jQuery){jQuery.fn.uapply=function(options){var matchedObject=this;matchedObject.uasync();matchedObject.uconfigurations();matchedObject.utopbar();matchedObject.uscan();var menu=matchedObject.filter(".system-menu");menu.umenu();var menu=jQuery(".system-menu",matchedObject);menu.umenu();var chat=jQuery(".chat",matchedObject)
chat.uchat();var notifications=jQuery(".notifications-menu",matchedObject);notifications.unotifications();var eureka=jQuery(".eureka",matchedObject);eureka.ueureka();var summary=jQuery(".summary",matchedObject);summary.usummary();var report=jQuery(".report",matchedObject);report.ureport();var activty=jQuery(".activity-list",matchedObject);activty.uactivity();var side=jQuery(".sidebar-section",matchedObject);side.uside();var sidebarOpen=jQuery(".sidebar-open",matchedObject);sidebarOpen.usidebaropen();var sidebarOverlay=jQuery(".sidebar-overlay",matchedObject);sidebarOverlay.usidebaroverlay();var image=jQuery(".lightbox-trigger, .entity-big-picture > img",matchedObject);image.ulightbox();};})(jQuery);(function(jQuery){jQuery.fn.uasync=function(){var SHOW_NOTIFICATION=false;var matchedObject=this;var _validate=function(){var _body=jQuery("body");var async=!_body.hasClass("noajax");return window.FormData?async:false;};var _registerHandlers=function(){var _body=jQuery("body");var links=jQuery("a[href], .link[href]",matchedObject);links=links.filter(":not(.link-confirm)");links.click(function(event){if(event.metaKey||event.ctrlKey){return;}
if(event.which===2||event.which===3){return;}
var element=jQuery(this);var href=element.attr("href");var noAsync=element.hasClass("no-async");if(noAsync){return;}
var target=element.attr("target");if(target&&target!=="_self"){return;}
var result=jQuery.uxlinkasync(href,false);result&&event.preventDefault();});var async=_body.data("async")||false;if(async){return;}
_body.bind("data",function(event,data,href,uuid,push,hbase){uuid=uuid||jQuery.uxguid();hbase=hbase||href;var relative=href.replace(/^(?:\/\/|[^\/]+)*\//,"/");var state={uuid:uuid,href:href};try{data=data.replace(/src=/ig,"aux-src=");var base=jQuery(data);var bodyData=data.match(/<body[^\0]*>[^\0]*<\/body>/ig)[0];bodyData=bodyData.replace("body","body_");var body=jQuery(bodyData);var _isFull=isFull();var _isSimple=isSimple();var _isBaseFull=isBaseFull(base);var _isBaseSimple=isBaseSimple(base);var isValid=(_isFull||_isSimple)&&(_isBaseFull||_isBaseSimple);if(!isValid){throw"Invalid layout or layout not found";}
_body.triggerHandler("pre_async");_body.hide();updateBase(hbase);var isUpdateFull=_isFull&&_isBaseFull;if(isUpdateFull){updateFull(base,body);}else{updateSimple(base,body);}
_body.triggerHandler("do_async",[base,body]);updateGuid(uuid);updateRelative(relative);_body.show();_body.scrollTop(0);_body.triggerHandler("post_async");push&&window.history.pushState(state,null,href);push&&window._gaq&&_gaq.push(["_trackPageview",relative]);push&&window.ga&&ga("send",{hitType:"pageview",page:relative});push&&window.google_trackConversion&&trackConversion();}catch(exception){document.location=href;}});_body.bind("async",function(){var _isFull=isFull();var _isSimple=isSimple();return _isFull||_isSimple;});_body.bind("async_start",function(){if(SHOW_NOTIFICATION){var loading=jQuery.uxlocale("Loading");var container=jQuery(".header-notifications-container");container.empty();var notification=jQuery("<div class=\"header-notification warning\"><strong>"+
loading+"</strong></div>");container.append(notification);}
var topLoader=jQuery(".top-loader");if(topLoader.length===0){var rightPanel=jQuery(".top-bar > .content-wrapper > .right");var topLoader=jQuery("<div class=\"top-loader\">"+"<div class=\"loader-background\"></div>"+"</div>");rightPanel.after(topLoader);}
topLoader.width(0);topLoader.show();topLoader.animate({width:60},100);});_body.bind("async_end",function(){if(SHOW_NOTIFICATION){var container=jQuery(".header-notifications-container");var notification=jQuery(".header-notification",container);notification.remove();}
var topLoader=jQuery(".top-loader");topLoader.animate({width:566},150,function(){var isVisible=topLoader.is(":visible");if(isVisible){topLoader.fadeOut(150);}else{topLoader.hide();}});});_body.bind("location",function(event,location){var result=jQuery.uxlinkasync(location,false);return!result;});_body.data("async",true);};var _setPopHandler=function(){if(window.onpopstate!==null&&window.onpopstate!==undefined){return;}
var href=document.location.href;var state={uuid:jQuery.uxguid(),href:href};window.history.replaceState(state,null,href);updateGuid(state.uuid);window.onpopstate=function(event){var _body=jQuery("body");var uuid=event.state?event.state.uuid:null;if(uuid&&uuid===_body.attr("uuid")){return;}
if(event.state===null){var href=document.location.href;var state={uuid:jQuery.uxguid(),href:href};window.history.replaceState(state,null,href);updateGuid(state.uuid);return;}
var href=document.location.href;jQuery.uxlinkasync(href,true,uuid);};};var result=_validate();if(!result){var _body=jQuery("body");_body.data("async",false);return;}
_registerHandlers();setTimeout(_setPopHandler);};var isFull=function(){var hasTopBar=jQuery(".top-bar").length>0;if(!hasTopBar){return false;}
var hasSideLeft=jQuery(".sidebar-left").length>0
if(!hasSideLeft){return false;}
return true;};var isSimple=function(){var hasTopBar=jQuery(".top-bar").length>0;if(!hasTopBar){return false;}
var contentWrapper=jQuery("body > .content-wrapper");var childCount=contentWrapper.children().length;if(childCount!==1){return false;}
return true;};var isBaseFull=function(base){var hasTopBar=base.filter(".top-bar");if(!hasTopBar){return false;}
var hasSideLeft=jQuery(".sidebar-left",base).length>0
if(!hasSideLeft){return false;}
return true;};var isBaseSimple=function(base){var contentWrapper=base.filter(".content-wrapper");var childCount=contentWrapper.children().length;if(childCount!==1){return false;}
return true;};var updateBase=function(hbase){var _base=jQuery("head base");if(_base.length===0){var _head=jQuery("head");var _base=jQuery("<base></base>");_head.append(_base);}
_base.attr("href",hbase);};var updateGuid=function(uuid){var _body=jQuery("body");_body.attr("uuid",uuid);};var updateRelative=function(relative){var _body=jQuery("body");_body.attr("relative",relative);};var updateFull=function(base,body){updateBody(body);updateIcon(base);updateResources(base);updateLocale(base);updateMeta(base);updateWindow(base);updateHeaderImage(base);updateSecondLeft(base);updateMenu(base);updateNotification(base);updateContent(base);updateFooter(base);updateNavigationList(base);updateSidebarRight(base);updateSidebarOpen(base);updateOverlaySearch(base);updateNotifications(base);updateChat(base);runGarbage(base);};var updateSimple=function(base,body){updateBody(body);updateIcon(base);updateResources(base);updateLocale(base);updateMeta(base);updateWindow(base);updateHeaderImage(base);updateSecondLeft(base);updateMenu(base);updateNotification(base);updateContentFull(base);updateFooter(base);updateOverlaySearch(base);updateNotifications(base);updateChat(base);runGarbage(base);};var updateBody=function(body){var _body=jQuery("body");var bodyClass=body.attr("class");var bodyStyle=body.attr("style")||"";var isVisible=body.is(":visible");bodyStyle+=isVisible?"":"display:none;";_body.attr("class",bodyClass);_body.attr("style",bodyStyle);_body.uxbrowser();_body.uxfeature();_body.uxmobile();_body.uxresponsive();};var updateIcon=function(base){var icon=base.filter("[rel=\"shortcut icon\"]");var icon_=jQuery("[rel=\"shortcut icon\"]");icon_.replaceWith(icon);};var updateResources=function(base){var _head=jQuery("head");var _body=jQuery("body");var section=jQuery("#section",base);var basePath=jQuery("#base-path",base);var section_=jQuery(".meta > #section");var sectionValue=section.html();var sectionValue_=section_.html();var basePathValue=basePath.html();var isDifferent=sectionValue!==sectionValue_;if(!isDifferent){return;}
var sectionsL=_body.data("sections_l")||{};_body.data("sections_l",sectionsL);sectionsL[sectionValue_]=true;var exists=sectionsL[sectionValue]||false;if(exists){return;}
_head.append("<link rel=\"stylesheet\" href=\""+basePathValue+"resources/css/layout.css\" type=\"text/css\" />");_head.append("<script type=\"text/javascript\" src=\""+basePathValue+"resources/js/main.js\"></script>");};var updateLocale=function(base){var locale=jQuery("#locale",base);var locale_=jQuery("[data-locale]");var language=locale.html().replace("_","-");locale_.attr("data-locale",language);};var updateMeta=function(base){var _body=jQuery("body");var meta=base.filter(".meta")
var meta_=jQuery(".meta");var metaHtml=meta.html();metaHtml=metaHtml.replace(/aux-src=/ig,"src=");meta_.html(metaHtml);meta_.uxapply();_body.uconfigurations();};var updateHeaderImage=function(base){var topBar=base.filter(".top-bar");var headerImage=jQuery(".header-logo-area",topBar);var headerImage_=jQuery(".top-bar .header-logo-area");var headerImageClass=headerImage.attr("class");var headerImageLink=headerImage.attr("href");headerImage_.attr("class",headerImageClass);headerImage_.attr("href",headerImageLink);};var updateSecondLeft=function(base){var topBar=base.filter(".top-bar");var secondLeft=jQuery(".left:nth-child(2)",topBar);var secondLeft_=jQuery(".top-bar .left:nth-child(2)");var secondLeftHtml=secondLeft.html();secondLeftHtml=secondLeftHtml.replace(/aux-src=/ig,"src=");secondLeft_.html(secondLeftHtml);secondLeft_.uxapply();};var updateMenu=function(base){var topBar=base.filter(".top-bar");var menu=jQuery(".system-menu",topBar);var menu_=jQuery(".top-bar .system-menu");var menuHtml=menu.html();menuHtml=menuHtml.replace(/aux-src=/ig,"src=");menu_.replaceWith("<div class=\"menu system-menu\">"+menuHtml+"</div>");menu_=jQuery(".top-bar .system-menu");menu_.uxapply();menu_.uxmenu();};var updateNotification=function(base){var container=jQuery(".header-notifications-container");var notifications=jQuery(".header-notification",base);container.empty();container.append(notifications);container.uxapply();};var updateContent=function(base){var content=jQuery(".content",base);var content_=jQuery(".content");var contentClass=content.attr("class")
var contentHtml=content.html();var isShortcuts=content.hasClass("shortcuts");contentHtml=contentHtml.replace(/aux-src=/ig,"src=");content_.html(contentHtml);content_.attr("class",contentClass);content_.uxapply();isShortcuts&&content_.uxshortcuts();};var updateContentFull=function(base){var content=base.filter(".content-wrapper");var content_=jQuery("body > .content-wrapper");fixContent(base,content);var contentClass=content.attr("class");var contentHtml=content.html();contentHtml=contentHtml.replace(/aux-src=/ig,"src=");content_.html(contentHtml);content_.attr("class",contentClass);content_.uxapply();};var updateFooter=function(base){var footer=base.filter(".footer");var footer_=jQuery(".footer");var footerHtml=footer.html();footerHtml=footerHtml.replace(/aux-src=/ig,"src=");footer_.html(footerHtml);footer_.uxapply();};var updateWindow=function(base){var windowOuter=base.filter(".window")
var windowInner=jQuery(".window",base);var window=windowOuter.add(windowInner);var window_=jQuery(".window");var overlay=jQuery(".overlay");overlay.hide();var placeholder=jQuery(".window-placeholder");if(placeholder.length===0){var _body=jQuery("body");placeholder=jQuery("<div class=\"window-placeholder\"></div>");_body.append(placeholder);}
window_.remove();placeholder.empty();placeholder.append(window);placeholder.uxapply();};var updateNavigationList=function(base){var navigationList=jQuery(".sidebar-left > .navigation-list",base);var navigationList_=jQuery(".sidebar-left > .navigation-list");var navigationListHtml=navigationList.html();navigationListHtml=navigationListHtml.replace(/aux-src=/ig,"src=");navigationList_.html(navigationListHtml);navigationList_.uxapply();navigationList_.uxlist();};var updateSidebarRight=function(base){var sidebarRight=jQuery(".sidebar-right",base);var sidebarRight_=jQuery(".sidebar-right");if(sidebarRight_.length===0){var content_=jQuery(".content");content_.after(sidebarRight);}
var sidebarRightHtml=sidebarRight.html()||"";sidebarRightHtml=sidebarRightHtml.replace(/aux-src=/ig,"src=");sidebarRight_.html(sidebarRightHtml);sidebarRight_.uxapply();};var updateSidebarOpen=function(base){var sidebarOpen=jQuery(".sidebar-open",base);var sidebarOpen_=jQuery(".sidebar-open");if(sidebarOpen.length===0||sidebarOpen_.length===0){return;}
var sidebarOpenHtml=sidebarOpen.html();sidebarOpenHtml=sidebarOpenHtml.replace(/aux-src=/ig,"src=");sidebarOpen_.html(sidebarOpenHtml);sidebarOpen_.uxapply();};var updateOverlaySearch=function(base){var overlaySearch=base.filter(".overlay-search");var overlaySearch_=jQuery(".overlay-search");var overlaySearchHtml=overlaySearch.html();overlaySearchHtml=overlaySearchHtml.replace(/aux-src=/ig,"src=");overlaySearch_.html(overlaySearchHtml);overlaySearch_.uxapply();overlaySearch_.uxoverlaysearch();};var updateNotifications=function(base){var notitifications=jQuery(".top-bar .notifications-menu");notitifications.triggerHandler("refresh");notitifications.triggerHandler("hide");};var updateChat=function(base){var chat=jQuery(".chat",base);var chat_=jQuery(".chat");var exists=chat_.length>0;if(exists){var sideLeft=jQuery(".sidebar-left");var chatParent=jQuery(".chat-parent");if(sideLeft.length>0){var parent=chat_.parent(".sidebar-left")
parent.length===0&&sideLeft.append(chat_);}else{var parent=chat_.parent(".chat-parent")
parent.length===0&&chatParent.append(chat_);}
var url=chat.attr("data-url");var baseUrl=chat.attr("data-base_url");var key=chat.attr("data-key");chat_.attr("data-url",url);chat_.attr("data-base_url",baseUrl);chat_.attr("data-key",key);chat_.triggerHandler("init");chat_.triggerHandler("refresh");}else{var sideLeft=jQuery(".sidebar-left");sideLeft.append(chat);chat.uchat();}};var runGarbage=function(base){var gcElements=jQuery(".gc");gcElements.each(function(index,element){var _element=jQuery(this);_element.triggerHandler("collect");});};var fixContent=function(base,content){fixChat(base,content);};var fixChat=function(base,content){var _body=jQuery("body");var chatParent=jQuery(".chat-parent");var chat=jQuery(".chat");var parentQuery=chatParent.length>0?".chat-parent":"body";var parentTarget=jQuery(parentQuery);var parent=chat.parent(parentQuery);parent.length===0&&parentTarget.append(chat);if(chat.length>0){var _chat=jQuery(".chat",content);_chat.remove();}};var trackConversion=function(){var meta=jQuery(".meta");var conversionId=jQuery("[name=adwords-conversion-id]",meta);var itemId=jQuery("[name=adwords-dynx-itemid]",meta);var totalValue=jQuery("[name=adwords-dynx-totalvalue]",meta);var pageType=jQuery("[name=adwords-dynx-pagetype]",meta);if(!window.google_trackConversion){return;}
if(!conversionId||conversionId.length===0){return;}
conversionId=parseInt(conversionId.attr("content"));if(!conversionId){return;}
totalValue=parseFloat(totalValue.attr("content"));pageType=pageType.attr("content");var itemIdList=[];itemId.each(function(index,element){var _element=jQuery(this);var elementId=_element.text();itemIdList.push(elementId);});google_trackConversion({google_conversion_id:conversionId,google_custom_params:{dynx_itemid:itemIdList,dynx_totalvalue:totalValue,dynx_pagetype:pageType},google_remarketing_only:true});};})(jQuery);(function(jQuery){jQuery.fn.uconfigurations=function(options){var matchedObject=this;var isBody=matchedObject.is("body");if(!isBody){return;}
var basePath=jQuery("#base-path",matchedObject).html();var mvcPath=jQuery("#mvc-path",matchedObject).html();var locale=jQuery("#locale",matchedObject).html();var objectId=jQuery("#object-id",matchedObject).html();var username=jQuery("#username",matchedObject).html();var representation=jQuery("#representation",matchedObject).html();var definitionsS=jQuery("#definitions",matchedObject).html();var aliasS=jQuery("#alias",matchedObject).html();var definitions=definitionsS?jQuery.parseJSON(definitionsS):{};var alias=aliasS?jQuery.parseJSON(aliasS):{};var sections=definitions["sections"]||{};var classIdUrl=definitions["class_id_url"]||{};var paths={};for(name in sections){var section=sections[name];var path=alias[section]||section;paths[name]=path;}
var tagRegex=new RegExp("\%\[[a-z]+\]","g");for(classId in classIdUrl){var url=classIdUrl[classId];while(true){var result=tagRegex.exec(url);if(result===null||result===undefined){break;}
result=result[0];var name=result.slice(2,result.length-1)
var path=paths[name]
url=url.replace(result,path);}
classIdUrl[classId]=url;}
matchedObject.data("base_path",basePath);matchedObject.data("mvc_path",mvcPath);matchedObject.data("locale",locale);matchedObject.data("object_id",objectId);matchedObject.data("username",username);matchedObject.data("representation",representation);matchedObject.data("definitions",definitions);matchedObject.data("alias",alias);matchedObject.data("sections",sections);matchedObject.data("class_id_url",classIdUrl);};})(jQuery);(function(jQuery){jQuery.udates=function(timestamp){var dateS="n/a";if(timestamp<60){dateS=jQuery.uxlocale("time:just_now");}else if(timestamp<3600){var minutes=Math.round(timestamp/60);var label=minutes===1?"min ago":"mins ago";dateS=String(minutes)+" "+jQuery.uxlocale(label);}else if(timestamp<86400){var hours=Math.round(timestamp/3600);var label=hours===1?"hour ago":"hours ago";dateS=String(hours)+" "+jQuery.uxlocale(label);}else{var days=Math.round(timestamp/86400);var label=days===1?"day ago":"days ago";dateS=String(days)+" "+jQuery.uxlocale(label);}
return dateS;};})(jQuery);(function(jQuery){jQuery.uquery=function(param){var _body=jQuery("body");var mvcPath=_body.data("mvc_path");if(!mvcPath){throw jQuery.uxexception("No mvc path variable defined");}
var alias=_body.data("alias")||{};var type=param["type"]||"get";var url=param["url"];var data=param["data"];var complete=param["complete"];var success=param["success"];var error=param["error"];var urlSplit=url.split("/");var section=urlSplit[0];var remainder=urlSplit.slice(1);var sectionUrl=alias[section]||section;url=sectionUrl+"/"+remainder.join("/")
url=mvcPath+url;var filters=data["filters"]||[];var _filters=[];for(var index=0;index<filters.length;index++){var filter=filters[index];var name=filter[0];var value=filter.length===3?String(filter[2]):String(filter[1]);var operation=filter.length===3?filter[1]:"equals";var _filter=name+":"+operation+":"+value;_filters.push(_filter);}
data["filters[]"]=_filters;delete data["filters"];jQuery.ajax({type:type,url:url,data:data,complete:complete,success:success,error:error});};})(jQuery);(function(jQuery){jQuery.fn.umenu=function(options){var matchedObject=this;matchedObject.each(function(index,element){var _element=jQuery(this);var _switch=jQuery(".switch",_element);var back=jQuery(".back",_element);_element.bind("show",function(){var element=jQuery(this);var menu=_element;var accountPanel=jQuery(".account-panel",menu);var switchPanel=jQuery(".switch-panel",menu);switchPanel.hide();accountPanel.show();element.uxmenulink("reposition");});_switch.click(function(){var element=jQuery(this);var menu=element.parents(".menu");var accountPanel=jQuery(".account-panel",menu);var switchPanel=jQuery(".switch-panel",menu);accountPanel.hide();switchPanel.show();menu.uxmenulink("reposition");});back.click(function(){var element=jQuery(this);var menu=element.parents(".menu");var accountPanel=jQuery(".account-panel",menu);var switchPanel=jQuery(".switch-panel",menu);accountPanel.show();switchPanel.hide();menu.uxmenulink("reposition");});});return this;};})(jQuery);(function(jQuery){jQuery.fn.uscan=function(options){var SCAN_CODE_LENGTH=22;var COMPATIBLE_VERSIONS=[1];var matchedObject=this;var isBody=matchedObject.is("body");if(!isBody){return;}
var _document=jQuery(document);var _body=jQuery("body");_document.bind("scan",function(event,value){var element=jQuery(this);var mvcPath=_body.data("mvc_path");var classIdUrl=_body.data("class_id_url");if(value.length!==SCAN_CODE_LENGTH){return;}
var checksumS=value.slice(0,4);checksumS=parseInt(checksumS);checksumS=String(checksumS);var buffer=value.slice(4);var _checksumS=checksum(buffer);if(_checksumS!==checksumS){return;}
var version=value.slice(4,6);var classId=value.slice(6,10);var objectId=value.slice(10);var versionInt=parseInt(version);if(isNaN(versionInt)){return;}
var classIdInt=parseInt(classId);if(isNaN(classIdInt)){return;}
var objectIdInt=parseInt(objectId);if(isNaN(objectId)){return;}
var isCompatible=COMPATIBLE_VERSIONS.indexOf(versionInt)!==-1;if(!isCompatible){return;}
var classUrl=classIdUrl[classIdInt];if(!classUrl){return;}
event.uscan=true;try{element.triggerHandler("uscan",[versionInt,classIdInt,objectIdInt]);}catch(exception){return;}
var baseUrl=mvcPath+classUrl;objectId=objectId.replace(/^0+|\s+$/g,"");jQuery.uxlocation(baseUrl+objectId);});_document.bind("scan_error",function(event,value){});var checksum=function(buffer,modulus,salt){modulus=modulus||10000;salt=salt||"omni";var _buffer=buffer+salt;var counter=0;for(var index=0;index<_buffer.length;index++){var _byte=_buffer[index];var byteI=_byte.charCodeAt(0);counter+=byteI<<index;}
var checksum=counter%modulus;var checksumS=String(checksum);return checksumS;};};})(jQuery);(function(jQuery){jQuery.fn.uactivity=function(options){var matchedObject=this;var _body=jQuery("body");var mvcPath=_body.data("mvc_path");var classIdUrl=_body.data("class_id_url");var date=new Date();var current=date.getTime();matchedObject.each(function(index,element){var _element=jQuery(this);var items=jQuery("> li",_element);var links=jQuery(".link",items);items.each(function(index,element){var _element=jQuery(this);var data=jQuery(".data",_element);var time=jQuery(".time",_element);var description=jQuery(".activity-list-description",_element);var timeS=time.text();var timeF=parseFloat(timeS);var diff=(current/1000.0)-timeF;var diffS=jQuery.udates(diff);time.html(diffS);var dataS=data.text();var dataJ=jQuery.parseJSON(dataS);if(dataJ===null||dataJ===undefined){return;}
var message=dataJ["message"];var arguments=dataJ["arguments"];var meta=dataJ["meta"];message=jQuery.uxlocale(message);var target=meta[0];var cid=target[0];var objectId=target[1];var baseUrl=mvcPath+classIdUrl[cid];var link=baseUrl+objectId;message=String.prototype.formatC.apply(message,arguments);message=jQuery.utemplate(message,true);description.html(message);_element.attr("data-link",link);_element.uxbutton();});items.mouseenter(function(){var _element=jQuery(this);var next=_element.next();next.addClass("next");});items.mouseleave(function(){var _element=jQuery(this);var next=_element.next();next.removeClass("next");});links.click(function(event){event.stopPropagation();});});};})(jQuery);(function(jQuery){var BUNDLE_EN_US={"payment_method:cash":"Cash","payment_method:card":"Card","payment_method:check":"Check","payment_method:credit_note":"Credit Note","payment_method:easypay":"Easypay","payment_method:paypal":"Paypal","physical_signature:signed":"Signed","physical_signature:not_signed":"Not Signed","physical_signature:unknown":"Unknown","time:just_now":"Just now","Signing in to chat server":"Signing in to chat server","You've been disconnected":"You've been disconnected","mae":"me","retrying ...":"retrying ...","says ...":"says ...","min ago":"min ago","mins ago":"mins ago","hour ago":"hour ago","hours ago":"hours ago","day ago":"day ago","days ago":"days ago","sold {{%s}} for {{%s}}":"sold {{%s}} for {{%s}}","consigned {{%s}} for {{%s}}":"consigned {{%s}} for {{%s}}","returned {{%s}} worth {{%s}} of sale {{%s}}":"returned {{%s}} worth {{%s}} of sale {{%s}}","created {{%s}}":"created {{%s}}","edited {{%s}}":"edited {{%s}}","deleted {{%s}}":"deleted {{%s}}","undeleted {{%s}}":"undeleted {{%s}}","confirmed {{%s}}":"confirmed {{%s}}","reserved {{%s}}":"reserved {{%s}}","sent {{%s}}":"sent {{%s}}","received {{%s}}":"received {{%s}}","closed {{%s}}":"closed {{%s}}","canceled {{%s}}":"canceled {{%s}}"}
jQuery.uxloadbundle(BUNDLE_EN_US,"en-us")})(jQuery);(function(jQuery){var BUNDLE_PT_PT={"payment_method:cash":"Dinheiro","payment_method:card":"Cartão","payment_method:check":"Cheque","payment_method:credit_note":"Nota de Crédito","payment_method:easypay":"Easypay","payment_method:paypal":"Paypal","physical_signature:signed":"Assinado","physical_signature:not_signed":"Não Assinado","physical_signature:unknown":"Desconhecido","time:just_now":"Agora mesmo","Signing in to chat server":"Ligando a servidor de chat","You've been disconnected":"Ligação a servidor perdida","mae":"eu","retrying ...":"tentando de novo ...","says ...":"diz ...","min ago":"min atrás","mins ago":"min atrás","hour ago":"hora atrás","hours ago":"horas atrás","day ago":"dia atrás","days ago":"dias atrás","sold {{%s}} for {{%s}}":"vendeu {{%s}} por {{%s}}","consigned {{%s}} for {{%s}}":"consignou {{%s}} por {{%s}}","returned {{%s}} worth {{%s}} of sale {{%s}}":"retornou {{%s}} no valor de {{%s}} da venda {{%s}}","created {{%s}}":"criou {{%s}}","edited {{%s}}":"editou {{%s}}","deleted {{%s}}":"apagou {{%s}}","undeleted {{%s}}":"restaurou {{%s}}","confirmed {{%s}}":"confirmou {{%s}}","reserved {{%s}}":"reservou {{%s}}","sent {{%s}}":"enviou {{%s}}","received {{%s}}":"recebeu {{%s}}","closed {{%s}}":"fechou {{%s}}","canceled {{%s}}":"cancelou {{%s}}"}
jQuery.uxloadbundle(BUNDLE_PT_PT,"pt-pt")})(jQuery);(function(jQuery){jQuery.fn.uchat=function(options){var matchedObject=this;if(!matchedObject||matchedObject.length===0){return;}
var _window=jQuery(window);var _body=jQuery("body");var placePanels=function(panels,animate){var windowHeight=_window.height();var windowWidth=_window.width();var extraMargin=14;for(var key in panels){var panel=panels[key];var panelHeight=panel.outerHeight(true);var panelWidth=panel.outerWidth(true);var panelOffset=panel.data("offset")||0;var chatTop=windowHeight-panelHeight+panelOffset;var chatLeft=windowWidth-panelWidth-extraMargin;!animate&&panel.uxanimation("disable");panel.css("top",chatTop+"px");panel.css("left",chatLeft+"px");extraMargin+=panelWidth+8;setTimeout(function(){!animate&&panel.uxanimation("enable");});}};var createItem=function(matchedObject,data){var budyList=jQuery(".buddy-list",matchedObject);var items=jQuery("li",budyList);var status=data["status"];var objectId=data["object_id"];var username=data["username"];var representation=data["representation"];var item=jQuery("<li class=\"budy-"+status+"\" data-user_id=\""+username+"\" data-object_id=\""+objectId+"\">"+representation+"</li>");var target=null;items.each(function(){var element=jQuery(this);var value=element.text();if(value<=representation){return;}
target=element;return false;});target?target.before(item):budyList.append(item);item.click(function(){var element=jQuery(this);var name=element.html();var userId=element.attr("data-user_id");var objectId=element.attr("data-object_id");matchedObject.uchatpanel({owner:matchedObject,name:name,user_id:userId,object_id:objectId,focus:true});});};var dataProcessor=function(data,mid,timestamp){var isString=typeof data==="string";var jsonData=isString?jQuery.parseJSON(data):data;var type=jsonData["type"];switch(type){case"message":messageProcessor(jsonData,mid,timestamp);break;case"status":statusProcessor(jsonData);break;default:break;}};var messageProcessor=function(envelope,mid,timestamp){var _body=jQuery("body");var username=_body.data("username");var message=envelope["message"];var sender=envelope["sender"];var receiver=envelope["receiver"];var owner=sender===username?receiver:sender
var userStatus=matchedObject.data("user_status");var userS=userStatus[owner];if(!userS){return;}
var objectId=userS["object_id"];var representation=userS["representation"];var panel=jQuery(".chat-panel[data-user_id="+owner+"]",matchedObject);if(panel.length===0){panel=matchedObject.uchatpanel({owner:matchedObject,name:representation,user_id:owner,object_id:objectId});}
var myself=sender===username;var name=myself?"me":representation;var title=jQuery.uxlocale("says ...");title=name+" "+title;panel.trigger("restore");panel.uchatline({name:name,message:message,mid:mid,timestamp:timestamp});if(myself){panel.triggerHandler("unblink");}else{panel.triggerHandler("blink",[title]);var audio=jQuery("> audio",matchedObject);audio[0].play();}};var statusProcessor=function(envelope){var _body=jQuery("body");var username=_body.data("username");var status=envelope["status"];var objectId=envelope["object_id"];var _username=envelope["username"];var representation=envelope["representation"];var userStatus=matchedObject.data("user_status")||{};var userS=userStatus[_username]||{};userS["status"]=status;userS["object_id"]=objectId;userS["username"]=_username;userS["representation"]=representation;userStatus[_username]=userS;matchedObject.data("user_status",userStatus);if(username===_username){return;}
switch(status){case"offline":var item=jQuery(".buddy-list > li[data-user_id="+_username+"]",matchedObject)
item.remove();var panels=matchedObject.data("panels")||{};var panel=panels[representation];panel&&panel.triggerHandler("disable");break;default:var item=jQuery(".buddy-list > li[data-user_id="+_username+"]",matchedObject)
if(item.length===0){createItem(matchedObject,envelope);}
item.removeClass("budy-online");item.removeClass("budy-busy");item.removeClass("budy-unavailable");item.addClass("budy-"+status);var panels=matchedObject.data("panels")||{};var panel=panels[representation];panel&&panel.triggerHandler("enable");break;}};matchedObject.each(function(index,element){var _element=jQuery(this);var isRegistered=_element.data("registered")||false;if(isRegistered){return;}
_element.data("registered",true);var _body=jQuery("body");var username=_body.data("username");_element.data("username",username);var url=_element.attr("data-url");var absolueUrl=jQuery.uxresolve(url+"/pushi.json");var url=_element.attr("data-base_url");var key=_element.attr("data-key");var pushi=new Pushi(key,{baseUrl:url,authEndpoint:absolueUrl});pushi.bind("connect",function(event){this.subscribe("global");this.subscribe("presence-status");_element.removeClass("disconnected");_element.addClass("connected");var buddyList=jQuery("> .buddy-list",_element);buddyList.empty();});pushi.bind("disconnect",function(even){_element.removeClass("connected");_element.addClass("disconnected");var panels=_element.data("panels")||{};for(var key in panels){var panel=panels[key];panel.triggerHandler("disable");}});pushi.bind("subscribe",function(event,channel,data){if(channel!=="presence-status"){return;}
var buddyList=jQuery("> .buddy-list",_element);buddyList.empty();var members=data.members||{};for(var key in members){var member=members[key];var envelope={type:"status",status:"online",object_id:member.object_id,username:member.username,representation:member.representation};dataProcessor(envelope);}});pushi.bind("message",function(event,data,channel,mid,timestamp){dataProcessor(data,mid,timestamp);});pushi.bind("member_added",function(event,channel,member){var envelope={type:"status",status:"online",object_id:member.object_id,username:member.username,representation:member.representation};dataProcessor(envelope);});pushi.bind("member_removed",function(event,channel,member){var envelope={type:"status",status:"offline",object_id:member.object_id,username:member.username,representation:member.representation};dataProcessor(envelope);});_element.data("pushi",pushi);var sound=_element.attr("data-sound");var audio=jQuery("<audio src=\""+sound+"\" preload=\"none\"></audio>");_element.append(audio);audio[0].load();});matchedObject.bind("init",function(){var element=jQuery(this);var _body=jQuery("body");var username=_body.data("username");var isVisible=element.parent(".sidebar");if(isVisible.length>0){element.removeClass("invisible");}else{element.addClass("invisible");}
var signinS=jQuery.uxlocale("Signing in to chat server");var disconnectedS=jQuery.uxlocale("You've been disconnected");var retryingS=jQuery.uxlocale("retrying ...");var buddyList=jQuery("> .buddy-list",element);var loading=jQuery("> .loading",element);var disconnected=jQuery("> .disconnected",element);var hasBuddyList=buddyList.length>0;loading.remove();disconnected.remove();!hasBuddyList&&element.append("<ul class=\"list buddy-list\"></ul>");element.append("<div class=\"loading\">"+signinS+"<br /><b>"+username+"</b></div>");element.append("<div class=\"disconnected\">"+disconnectedS+"<br /><b>"+retryingS+"</b></div>");});matchedObject.bind("new_chat",function(){var panels=matchedObject.data("panels")||{};placePanels(panels,true);});matchedObject.bind("delete_chat",function(){var panels=matchedObject.data("panels")||{};placePanels(panels,true);});matchedObject.bind("refresh",function(){var element=jQuery(this);var _body=jQuery("body");var username=_body.data("username");var _username=element.data("username");if(username===_username){return;}
element.data("username",username);var panels=element.data("panels")||{};for(var key in panels){var panel=panels[key];panel.triggerHandler("close");}
element.data("panels",{})
var pushi=element.data("pushi");var url=element.attr("data-base_url");var key=element.attr("data-key");var isValid=pushi.isValid(key,url);if(isValid){pushi.invalidate("global");pushi.invalidate("presence-status");pushi.subscribe("global");pushi.subscribe("presence-status");}
else{pushi.reconfig(key,{baseUrl:url,authEndpoint:pushi.options.authEndpoint});}});matchedObject.bind("push",function(){var element=jQuery(this);var panels=element.data("panels")||{};for(var key in panels){var panel=panels[key];panel.triggerHandler("push");}});matchedObject.bind("pop",function(){var element=jQuery(this);var panels=element.data("panels")||{};for(var key in panels){var panel=panels[key];panel.triggerHandler("pop");}});matchedObject.length>0&&_window.resize(onResize=function(){var panels=matchedObject.data("panels")||{};placePanels(panels,false);});matchedObject.bind("destroyed",function(){_window.unbind("resize",onResize);});matchedObject.length>0&&_body.bind("pre_async",onPreAsync=function(){matchedObject.triggerHandler("push");});matchedObject.bind("destroyed",function(){_body.unbind("pre_async",onPreAsync);});matchedObject.length>0&&_body.bind("post_async",onPostAsync=function(){matchedObject.triggerHandler("pop");});matchedObject.bind("destroyed",function(){_body.unbind("post_async",onPostAsync);});matchedObject.triggerHandler("init");};})(jQuery);(function(jQuery){var MINIMUM_CONTENT_HEIGHT=80;jQuery.fn.uchatpanel=function(options){var matchedObject=this;var _body=jQuery("body");var owner=options["owner"];var name=options["name"];var userId=options["user_id"];var objectId=options["object_id"];var ownerId=options["owner_id"];var large=options["large"];var focus=options["focus"];large=large===undefined?owner.hasClass("large"):large;var username=_body.data("username");var channelNames=[username,userId];channelNames.sort();var channel=channelNames.join("&");var panels=matchedObject.data("panels")||{};var chatPanel=panels[name];if(chatPanel){chatPanel.triggerHandler("restore");return chatPanel;}
chatPanel=jQuery("<div class=\"chat-panel empty budy-available\">"+"<div class=\"chat-header\">"+
name+"<div class=\"chat-buttons\">"+"<div class=\"chat-button chat-settings\"></div>"+"<div class=\"chat-button chat-close\"></div>"+"</div>"+"</div>"+"<div class=\"chat-contents\"></div>"+"<div class=\"chat-message\">"+"<textarea type=\"text\" class=\"text-area\"></textarea>"+"<textarea type=\"text\" class=\"text-area hidden\"></textarea>"+"</div>"+"</div>");matchedObject.append(chatPanel);chatPanel.uxapply();chatPanel.hide();chatPanel.attr("data-user_id",userId);chatPanel.data("name",name);chatPanel.data("owner",owner);chatPanel.data("user_id",userId);chatPanel.data("object_id",objectId);chatPanel.data("owner_id",ownerId);large&&chatPanel.addClass("large");var currentScroll=0;var maxScrollHeight=0;var show=function(timeout){chatPanel.fadeIn(timeout);var contentsHeight=contents.height();currentScroll=textArea[0].scrollHeight;maxScrollHeight=currentScroll+contentsHeight-MINIMUM_CONTENT_HEIGHT;};var more=function(count,target){count=count||20;var pending=chatPanel.data("pending");if(pending){setTimeout(function(){more(count,target);},100);return;}
chatPanel.data("pending",true);var chatLines=jQuery(".chat-line",chatPanel);var skip=chatLines.length;var pushi=owner.data("pushi");pushi.latest("peer-status:"+channel,skip,count,function(channel,data){var events=data.events;for(var index=0;index<events.length;index++){var event=events[index];var mid=event.mid;var timestamp=event.timestamp;var _data=event.data.data;var struct=_data?jQuery.parseJSON(_data):_data;chatPanel.uchatline({name:struct.sender===username?"me":name,message:struct.message,mid:mid,timestamp:timestamp,target:target});}
chatPanel.data("pending",false);});};setTimeout(function(){show(75);});more();var header=jQuery(".chat-header",chatPanel);var contents=jQuery(".chat-contents",chatPanel);var message=jQuery(".chat-message",chatPanel);var buttonClose=jQuery(".chat-close",chatPanel);var buttonMinimize=jQuery(".chat-minimize",chatPanel);var textArea=jQuery(".chat-message > .text-area:not(.hidden)",chatPanel);var textAreaHidden=jQuery(".chat-message > .text-area.hidden",chatPanel);chatPanel.bind("enable",function(){var element=jQuery(this);element.removeClass("disabled");var textArea=jQuery(".chat-message > .text-area:not(.hidden)",element);textArea.uxenable();});chatPanel.bind("disable",function(){var element=jQuery(this);element.addClass("disabled");var textArea=jQuery(".chat-message > .text-area:not(.hidden)",element);textArea.uxdisable();element.triggerHandler("unblink");});chatPanel.bind("minimize",function(){var element=jQuery(this);var discrete=element.data("discrete")||false;if(discrete){contents.hide();message.hide();}else{var borderBottom=element.css("border-bottom");borderBottom=borderBottom||element.css("border-bottom-width");var borderWidth=parseInt(borderBottom);borderWidth=borderWidth||0;var contentsHeight=contents.outerHeight(true);var messageHeight=message.outerHeight(true);var offset=contentsHeight+messageHeight+borderWidth;element.data("offset",offset);}
element.triggerHandler("layout",[]);element.data("minimized",true);});chatPanel.bind("restore",function(){var element=jQuery(this);var discrete=element.data("discrete")||false;if(discrete){contents.show();message.show();}else{element.data("offset",0);}
element.triggerHandler("layout",[]);element.data("minimized",false);});chatPanel.bind("layout",function(){var element=jQuery(this);var offset=element.data("offset")||0;var _window=jQuery(window);var windowHeight=_window.height();var panelHeight=element.outerHeight(true);var panelTop=windowHeight-panelHeight+offset;element.css("top",panelTop+"px");});chatPanel.bind("blink",function(event,message){var element=jQuery(this);var textArea=jQuery(".chat-message > .text-area:not(.hidden)",element);var isFocused=textArea.is(":focus");if(isFocused){return;}
var _handler=element.data("blink");if(_handler){return;}
message=message||"blink";var owner=element.data("owner");var title=owner.data("title_s")||document.title;owner.data("title_s",title);var _handlerT=owner.data("title");_handlerT&&clearInterval(_handlerT);var handlerT=setInterval(function(){if(document.title===title){document.title=message;}else{document.title=title;}},1250);owner.data("title",handlerT)
element.data("title",handlerT)
element.addClass("blink");var handler=setInterval(function(){element.toggleClass("blink");},1250);element.data("blink",handler)});chatPanel.bind("unblink",function(){var element=jQuery(this);var handler=element.data("blink");var owner=element.data("owner");var handlerT=element.data("title");var _handlerT=owner.data("title");var title=owner.data("title_s");var isSame=handlerT&&handlerT===_handlerT;if(isSame){clearInterval(_handlerT);document.title=title
owner.data("title",null);}
handler&&clearInterval(handler);element.removeClass("blink");element.data("title",null);element.data("blink",null);});chatPanel.bind("close",function(){var element=jQuery(this);element.triggerHandler("unblink");var panels=matchedObject.data("panels")||{};delete panels[name];chatPanel.fadeOut(50,function(){chatPanel.remove();matchedObject.triggerHandler("delete_chat",[]);});});chatPanel.bind("push",function(){var element=jQuery(this);var contents=jQuery(".chat-contents",element);var scrollTop=contents.scrollTop();var state={scrollTop:scrollTop};element.data("state",state);});chatPanel.bind("pop",function(){var element=jQuery(this);var contents=jQuery(".chat-contents",element);var state=element.data("state");if(!state){return;}
contents.scrollTop(state.scrollTop);element.data("state",null);});buttonClose.click(function(event){var element=jQuery(this);var chatPanel=element.parents(".chat-panel");chatPanel.triggerHandler("close");event.preventDefault();event.stopPropagation();});buttonMinimize.click(function(event){var minimized=chatPanel.data("minimized");if(minimized){chatPanel.triggerHandler("restore",[]);}else{chatPanel.triggerHandler("minimize",[]);}
event.preventDefault();event.stopPropagation();});header.click(function(){var minimized=chatPanel.data("minimized");if(minimized){chatPanel.triggerHandler("restore",[]);}else{chatPanel.triggerHandler("minimize",[]);}});contents.click(function(){var element=jQuery(this);var chatPanel=element.parents(".chat-panel");chatPanel.triggerHandler("unblink");});contents.scroll(function(){var element=jQuery(this);var counter=element.data("counter")||0;element.data("counter",counter+1);var scroll=element.scrollTop();if(scroll!==0){return;}
var first=jQuery("> :nth-child(2)",element);more(14,first);});textArea.focus(function(){var element=jQuery(this);var chatPanel=element.parents(".chat-panel");chatPanel.triggerHandler("unblink");});textArea.keydown(function(event){var keyValue=event.keyCode?event.keyCode:event.charCode?event.charCode:event.which;if(keyValue!==13){return;}
if(event.shiftKey){return;}
var message=textArea.val();message=message.trim();if(message===""){event.preventDefault();event.stopPropagation();return;}
var data=JSON.stringify({type:"message",sender:username,receiver:userId,message:message});var pushi=owner.data("pushi");pushi.sendChannel("message",data,"peer-status:"+channel,true);textArea.val("");event.preventDefault();event.stopPropagation();});textArea.bind("value_change",function(event,value){var element=jQuery(this);textAreaHidden.val(value);textAreaHidden.show();var scrollHeight=textAreaHidden[0].scrollHeight;textAreaHidden.hide();scrollHeight=scrollHeight>maxScrollHeight?maxScrollHeight:scrollHeight;var delta=scrollHeight-currentScroll;var changed=delta!==0;currentScroll=scrollHeight;if(!changed){return;}
var contentsHeight=contents.height();var messageHeight=message.height();var textAreaHeight=textArea.height();var contentsScroll=contents.scrollTop();var contentsScrollHeight=contents[0].scrollHeight;var contentsOffset=contentsHeight-contentsScroll;var contentsBottom=contentsScroll+contentsHeight===contentsScrollHeight;contents.height(contentsHeight-delta);message.height(messageHeight+delta);textArea.height(textAreaHeight+delta);if(!contentsBottom){return;}
contentsScrollHeight=contents[0].scrollHeight;contents.scrollTop(contentsScrollHeight);});focus&&setTimeout(function(){textArea.focus();});panels[name]=chatPanel;matchedObject.data("panels",panels);matchedObject.triggerHandler("new_chat",[]);return chatPanel;};})(jQuery);(function(jQuery){jQuery.fn.uchatline=function(options){var matchedObject=this;var _body=jQuery("body");var mvcPath=_body.data("mvc_path");var alias=_body.data("alias")||{};var admSection=alias["omni_adm"]||"omni_adm";var name=options["name"]||matchedObject.data("name");var objectId=options["object_id"]||matchedObject.data("object_id");var message=options["message"];var mid=options["mid"]||"";var timestamp=options["timestamp"]||new Date().getTime()/1000;var plain=options["plain"]||false;var target=options["target"]||null;var bottom=options["bottom"]||false;var date=new Date(timestamp*1000);var dateS=_body.uxtimestamp("format",{date:date,format:"%d/%m %H:%M"});var contents=jQuery(".chat-contents",matchedObject);var previous=jQuery(".chat-line[data-mid=\""+mid+"\"]",contents);if(mid&&previous.length>0){return previous;}
var nameLocale=name==="me"?jQuery.uxlocale(name):name;message=message.replace("\n","<br/>");if(plain===false){result=jQuery.uchatreplacer(message);message=result[0];extras=result[1];options["message"]=extras;options["plain"]=true;extras&&matchedObject.uchatline(options);}
objectId=name==="me"?_body.data("object_id"):objectId;var imageUrl=mvcPath+admSection+"/users/"+objectId+"/image?size=32";var paragraphs=jQuery("> .chat-paragraph",contents);var paragraph=null;for(var index=paragraphs.length-1;index>=0;index--){var _paragraph=jQuery(paragraphs[index]);var _previous=jQuery(paragraphs[index-1]);var _name=_paragraph.data("name");var _dateS=_paragraph.data("date");var _timestamp=_paragraph.data("timestamp")||0;var _reference=_previous.data("timestamp")||0;var isFirst=index===paragraphs.length-1;var isInitial=isFirst&&_timestamp<timestamp;var isBuble=_name===name&&_dateS===dateS&&_reference<timestamp;if(!isInitial&&!isBuble&&!bottom){continue;}
paragraph=_paragraph;break;}
var _name=paragraph?paragraph.data("name"):null;var _timestamp=paragraph?paragraph.data("timestamp"):0;var _dateS=paragraph?paragraph.data("date"):"";if(name!==_name||dateS!==_dateS){var reference=paragraph;var isTop=reference===null||reference===undefined;var date=new Date(timestamp*1000);var timeString=_body.uxtimestamp("format",{date:date,format:"%d/%m %H:%M"});var dayString=_body.uxtimestamp("format",{date:date,format:"%d %B %Y"});var day=jQuery("<div class=\"chat-day\">"+dayString+"</div>");day.attr("data-string",dayString);day.data("timestamp",timestamp);var previousDay=jQuery("[data-string=\""+dayString+"\"]",contents);var previousTimestamp=previousDay.data("timestamp");var addDay=!previousTimestamp||previousTimestamp>=timestamp;addDay&&previousDay.remove();var separator=jQuery("<div class=\"chat-separator\"></div>");if(!isTop){reference.after(separator);reference=separator;}
paragraph=jQuery("<div class=\"chat-paragraph\">"+"<div class=\"chat-name\">"+nameLocale+"</div>"+"<div class=\"chat-time\">"+timeString+"</div>"+"</div>");paragraph.css("background-image","url("+imageUrl+")");paragraph.css("background-repeat","no-repeat");paragraph.attr("data-date",timeString);paragraph.data("data-date",timeString);paragraph.data("name",name);if(isTop){contents.prepend(paragraph);addDay&&contents.prepend(day);}else{reference.after(paragraph);addDay&&reference.after(day);}
if(isTop&&paragraphs.length>0){paragraph.after(separator);}}
var chatLine=jQuery("<div class=\"chat-line\">"+message+"</div>");chatLine.attr("data-mid",mid);chatLine.attr("timestamp",String(timestamp));chatLine.attr("date",dateS);chatLine.data("timestamp",timestamp);chatLine.data("date",dateS);var chatLines=jQuery(".chat-line",paragraph);var position=jQuery(".chat-time",paragraph);for(var index=0;index<chatLines.length;index++){var _chatLine=jQuery(chatLines[index]);var _timestamp=_chatLine.data("timestamp");if(_timestamp>timestamp){break;}
position=_chatLine;}
position.after(chatLine);chatLine.uxapply();var lastLine=jQuery(".chat-line:last",paragraph);var lastTimestamp=lastLine.data("timestamp");paragraph.data("timestamp",timestamp);paragraph.attr("timestamp",timestamp);if(target){target=jQuery(target);var targetMargin=parseInt(target.css("margin-top"));targetMargin=isNaN(targetMargin)?0:targetMargin;var settings={offset:targetMargin*-1};var fixScroll=function(){contents.uxscrollto(target,0,settings);};}
else{var fixScroll=function(){var scrollHeight=contents[0].scrollHeight;contents.scrollTop(scrollHeight);};}
var isVisible=contents.is(":visible");isVisible&&fixScroll();!isVisible&&setTimeout(function(){fixScroll();});var counter=contents.data("counter")||0;var images=jQuery("img",chatLine);images.load(function(){var _counter=contents.data("counter");if(counter!==_counter){return;}
fixScroll();});matchedObject.removeClass("empty");return chatLine;};})(jQuery);(function(jQuery){var IMAGE_REGEX=new RegExp(/(\b(https?):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*\.(png|jpg|jpeg|gif)[-A-Z0-9+&@#\/%?=~_|!:,.;]*)/ig);var YOUTUBE_REGEX=new RegExp(/(\b(https?):\/\/(www\.)?youtube.com[-A-Z0-9+&@#\/%?=~_|!:,.;]*)/ig);var URL_REGEX=new RegExp(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig);jQuery.uchatreplacer=function(message){var extras="";var parse=function(url){var parts=url.split("?");if(parts.length<2){return{};}
var query=parts[1];var assocs=query.split("&");var result={};for(var index=0;index<assocs.length;index++){var assoc=assocs[index];var struct=assoc.split("=");result[struct[0]]=struct[1];}
return result;};var image=function(message){var result=message.match(IMAGE_REGEX);if(!result){return message;}
result=result[0];extras+="<a href=\""+result+"\" target=\"_blank\">"+"<img src=\""+result+"\"/>"+"</a>";return result===message?"":message;};var youtube=function(message){var result=message.match(YOUTUBE_REGEX);if(!result){return message;}
result=result[0];var parsed=parse(result);var youtubeId=parsed["v"];extras+="<iframe height=\"200\""+" src=\"//www.youtube.com/embed/"+youtubeId+"?controls=0\""+" frameborder=\"0\"></iframe>";return result===message?"":message;};var url=function(message){message=message.replace(URL_REGEX,"<a href=\"$1\" target=\"_blank\" class=\"link link-blue\">$1</a>");return message;};message=image(message);message=youtube(message);message=url(message);return[message,extras];};})(jQuery);(function(jQuery){jQuery.fn.ueureka=function(options){var matchedObject=this;if(!matchedObject||matchedObject.length===0){return;}
var _body=jQuery("body");var overlayPanel=matchedObject.parents(".overlay-panel");var textField=jQuery(".text-field",matchedObject);textField.keydown(function(event){var element=jQuery(this);var overlayPanel=element.parents(".overlay-panel");var key=overlayPanel.attr("data-key");key=key?parseInt(key):key;var eventKeyCode=event.keyCode?event.keyCode:event.which;if(eventKeyCode===27||eventKeyCode===key){return;}
event.stopPropagation();event.stopImmediatePropagation();});overlayPanel.bind("shown",function(){var element=jQuery(this);var textField=jQuery(".text-field",element);textField.uxreset();});matchedObject.bind("item",function(event,item){var mvcPath=_body.data("mvc_path");var classIdUrl=_body.data("class_id_url");var objectId=item["object_id"];var cid=item["cid"];var baseUrl=mvcPath+classIdUrl[cid];var link=baseUrl+objectId;item["link"]=link;});matchedObject.bind("value_select",function(event,value,valueLogic,item){var element=jQuery(this);var overlayPanel=element.parents(".overlay-panel");overlayPanel.triggerHandler("hide");});matchedObject.length>0&&_body.bind("post_async",onPostAsync=function(){var overlayPanel=matchedObject.parents(".overlay-panel");overlayPanel.triggerHandler("hide");});matchedObject.bind("destroyed",function(){_body.unbind("post_async",onPostAsync);});};})(jQuery);(function(jQuery){jQuery.fn.ulightbox=function(options){var matchedObject=this;var _body=jQuery("body");matchedObject.addClass("lightbox-trigger");matchedObject.click(function(){var element=jQuery(this);var url=element.attr("src");var split=url.split("?");var base=split[0];var query=split.length>1?split[1]:"";var parts=query.split("&");var valid=[];for(var index=0;index<parts.length;index++){var part=parts[index];var invalid=part.startsWith("size=")||part.startsWith("fallback=");if(invalid){continue;}
valid.push(part);}
var validQuery=valid.join("&");var baseUrl=base+"?size=512&fallback=1&"+validQuery;var largeUrl=base+"?size=original&fallback=1&"+validQuery;_body.uxlightbox(baseUrl,null,largeUrl);var lightbox=jQuery(".window-lightbox",_body);var buttons=jQuery(".button-confirm, .button-expand",lightbox);buttons.uxanimation();var marked=lightbox.data("ulightbox");if(marked){return;}
lightbox.bind("shown",function(){buttons.uxanimation();});lightbox.bind("hidden",function(){buttons.uxanimation();});lightbox.bind("loading",function(){buttons.uxanimation();});lightbox.bind("loaded",function(){buttons.uxanimation();});lightbox.data("ulightbox",true);});return this;};})(jQuery);(function(jQuery){jQuery.fn.unotifications=function(options){var MAXIMUM_NOTIFICATIONS=5;var matchedObject=this;if(!matchedObject||matchedObject.length===0){return;}
var _window=jQuery(window);var _body=jQuery("body");var isRegistered=_window.data("notifications_global");_window.data("notifications_global",true);var link=jQuery("<div class=\"button menu-button menu-link notifications\"></div>")
var container=jQuery("<div class=\"menu-contents notifications-container\">"+"<ul class=\"notifications-list\"></ul>"+"</div>");matchedObject.append(link)
matchedObject.append(container);link.uxmenulink();matchedObject.each(function(index,element){var _element=jQuery(this);var link=jQuery(".menu-link",_element);var contents=jQuery(".menu-contents",_element);var list=jQuery(".notifications-list",_element);var url=_element.attr("data-url");var absolueUrl=jQuery.uxresolve(url+"/pushi.json");var username=_body.data("username");_element.data("username",username);var url=_element.attr("data-url");var key=_element.attr("data-key");var pushi=new Pushi(key,{baseUrl:url,authEndpoint:absolueUrl});_element.data("pushi",pushi);_element.bind("notification",function(event,data,isNew){var _element=jQuery(this);var mvcPath=_body.data("mvc_path");var basePath=_body.data("base_path");var classIdUrl=_body.data("class_id_url");var date=new Date();var current=date.getTime();var uniqueId=data.unique_id;var objectId=data.entity.object_id;var uobjectId=data.create_user.object_id;var cid=data.cid;var ucid=data.u_cid;var baseUrl=mvcPath+classIdUrl[cid];var baseUrlU=mvcPath+classIdUrl[ucid];var url=baseUrl+objectId;var urlU=baseUrlU+uobjectId;var urlR=jQuery.uxresolve(url);var diff=(current/1000.0)-data.create_date;var diffS=jQuery.udates(diff);var message=data.notification.message;var arguments=data.notification.arguments;message=jQuery.uxlocale(message);message=String.prototype.formatC.apply(message,arguments);var messageT=jQuery.utext(message);message=jQuery.utemplate(message,true);var imageUrl=urlU+"/image?size=128";var userName=data.create_user.representation;var time=diffS;var logoUrl=basePath+"common/images/logos/front-door-not-large.png";var notification=jQuery("<li class=\"button\" data-link=\""+url+"\">"+"<img class=\"entity-picture\" src=\""+imageUrl+"\">"+"<div class=\"contents\">"+"<p class=\"title\">"+userName+"</p>"+"<p class=\"subject\"></p>"+"</div>"+"<div class=\"time\">"+time+"</div>"+"<div class=\"break\"></div>"+"</li>");list.prepend(notification);notification.uxbutton();var items=jQuery("> li",list);var size=items.length;while(size>MAXIMUM_NOTIFICATIONS){var index=size;var element=jQuery("> li:nth-child("+index+")",list);element.remove();size--;}
notification.data("data",data)
isNew&&notification.addClass("pending");isNew&&link.addClass("pending");isNew&&_body.uxnotification({"title":userName,"message":message,"link":jQuery.uxresolve(url),"timeout":15000});var hasNotifications=typeof(Notification)!=="undefined";if(hasNotifications&&isNew){var _notification=new Notification(userName,{dir:"auto",icon:jQuery.uxresolve(logoUrl),lang:"en",body:messageT,tag:uniqueId});_notification.onclick=function(){window.open(urlR,"_blank");};_notification.show&&_notification.show();_notification.close&&setTimeout(function(){_notification.close();},15000);_body.data("_notification",_notification);}
_element.triggerHandler("refresh");});_element.bind("refresh",function(){var items=jQuery("li",list);var mvcPath=_body.data("mvc_path");var classIdUrl=_body.data("class_id_url");var itemsSize=items.length;if(itemsSize===0){link.uxdisable();}else{link.uxenable();}
var date=new Date();var current=date.getTime();items.each(function(index,element){var _element=jQuery(this);var data=_element.data("data");if(!data){return;}
var subject=jQuery(".subject",_element);var time=jQuery(".time",_element);var message=data.notification.message;var arguments=data.notification.arguments;message=jQuery.uxlocale(message);message=String.prototype.formatC.apply(message,arguments);message=jQuery.utemplate(message,true);subject.html(message);var diff=(current/1000.0)-data.create_date;var diffS=jQuery.udates(diff);time.html(diffS);var objectId=data.entity.object_id;var cid=data.cid;var baseUrl=mvcPath+classIdUrl[cid];var url=baseUrl+objectId;_element.attr("data-link",url);_element.data("link",url);});var username=_body.data("username");var _username=_element.data("username");if(username===_username){return;}
var pushi=_element.data("pushi");var url=_element.attr("data-base_url");var key=_element.attr("data-key");var isValid=pushi.isValid(key,url);if(isValid){pushi.unsubscribe("personal-"+_username);pushi.subscribe("personal-"+username);}
else{pushi.reconfig(key,{baseUrl:url,authEndpoint:pushi.options.authEndpoint});}
list.empty();link.uxdisable();_element.data("username",username);});!isRegistered&&_window.bind("beforeunload",function(){var _notification=_body.data("_notification");_notification&&_notification.close();});!isRegistered&&_window.bind("unload",function(){var _notification=_body.data("_notification");_notification&&_notification.close();});contents.bind("shown",function(){link.addClass("reading");});contents.bind("hidden",function(){var items=jQuery("li",list);var isReading=link.hasClass("reading");if(!isReading){return;}
link.removeClass("reading");items.removeClass("pending");link.removeClass("pending");});list.click(function(){_element.triggerHandler("hide");});pushi.bind("connect",function(event){var items=jQuery("li",list);list.empty();items.removeClass("pending");link.removeClass("pending");var username=_body.data("username");this.subscribe("personal-"+username);});pushi.bind("subscribe",function(event,channel,data){var isPersonal=channel.startsWith("personal-");if(!isPersonal){return;}
var events=data.events||[];var length=events.length>MAXIMUM_NOTIFICATIONS?MAXIMUM_NOTIFICATIONS:events.length;for(var index=length-1;index>=0;index--){var event=events[index];var data=event.data.data;var _data=data?jQuery.parseJSON(data):data;_element.triggerHandler("notification",[_data,false]);}});pushi.bind("notification",function(event,data,channel){var isString=typeof data==="string";data=isString?jQuery.parseJSON(data):data;_element.triggerHandler("notification",[data,true]);});setInterval(function(){var date=new Date();var current=date.getTime();var items=jQuery("li",list);items.each(function(index,element){var _element=jQuery(this);var data=_element.data("data");if(!data){return;}
var time=jQuery(".time",_element);var diff=(current/1000.0)-data.create_date;var diffS=jQuery.udates(diff);time.html(diffS);});},60000);});var buildNotification=function(){};matchedObject.triggerHandler("refresh");};})(jQuery);(function(jQuery){jQuery.fn.uside=function(options){var matchedObject=this;matchedObject.each(function(index,element){var _element=jQuery(this);var linksList=jQuery(".links-list",_element);if(linksList.length===0){return;}
var links=linksList.children();if(links.length!==0){return;}
_element.hide();});};})(jQuery);(function(jQuery){jQuery.fn.usidebaropen=function(options){var matchedObject=this;var _body=jQuery("body");var isRegistered=_body.data("sidebar_open");_body.data("sidebar_open",true);matchedObject.click(function(event){_body.triggerHandler("hide_modal");_body.addClass("side-right-visible");});!isRegistered&&_body.bind("hide_modal",function(){_body.removeClass("side-right-visible");_body.removeClass("side-left-visible");});};})(jQuery);(function(jQuery){jQuery.fn.usidebaroverlay=function(options){var matchedObject=this;var _body=jQuery("body");matchedObject.click(function(event){_body.removeClass("side-left-visible");_body.removeClass("side-right-visible");event.preventDefault();event.stopPropagation();});};})(jQuery);(function(jQuery){jQuery.fn.usummary=function(options){var VALUES=["count","sum","average"];var VALUES_LOCALE=jQuery.uxlocale(VALUES);var matchedObject=this;if(!matchedObject||matchedObject.length===0){return;}
matchedObject.each(function(index,element){var _element=jQuery(this);var reference=_element.attr("data-reference");var element=jQuery(reference);var sidebarList=jQuery("<ul class=\"sidebar-list\"></ul>");for(var index=0;index<VALUES.length;index++){var value=VALUES[index];var valueL=VALUES_LOCALE[index];var item=jQuery("<li class=\""+value+"\">"+"<span class=\"key\">"+valueL+"</span>"+"<span class=\"value\"></span>"+"<div class=\"sidebar-clear\"></div>"+"</li>");sidebarList.append(item)}
_element.append(sidebarList);var countElement=jQuery(".count > .value",_element);var sumElement=jQuery(".sum > .value",_element);var averageElement=jQuery(".average > .value",_element);_element.hide();element.bind("selected",function(event,elements){var isVisible=elements.length>1;var count=elements.length;var sum=0;elements.each(function(index,element){var _element=jQuery(this);var numbers=jQuery(".number",_element);var length=numbers.length;var target=jQuery(numbers[length-1]).html();var value=parseFloat(target);sum+=value;});var average=sum/count;var countS=count.toString();var sumS=sum.toFixed(2);var averageS=average.toFixed(2);countElement.uxvalue(countS);sumElement.uxvalue(sumS);averageElement.uxvalue(averageS);if(isVisible){_element.show();}else{_element.hide();}});element.bind("update_complete",function(event,reset){reset&&_element.hide();});});};})(jQuery);(function(jQuery){jQuery.fn.utopbar=function(options){var matchedObject=this;var _body=jQuery("body");var contentBar=jQuery(".content-bar",matchedObject);var contentMargin=jQuery(".content-margin",matchedObject);contentBar.click(function(event){_body.removeClass("side-left-visible");_body.removeClass("side-right-visible");});var handle=jQuery(".top-bar-handle",matchedObject);handle.click(function(){var element=jQuery(this);var slider=element.parents(".top-bar-slider");var isUp=element.hasClass("up");if(isUp){contentBar.removeClass("visible");contentMargin.removeClass("visible");slider.removeClass("visible");element.removeClass("up");}else{contentBar.addClass("visible");contentMargin.addClass("visible");slider.addClass("visible");element.addClass("up");}});var headerLogo=jQuery(".top-bar-logo .header-logo",matchedObject);headerLogo.click(function(event){var isMobile=_body.hasClass("mobile-s");if(!isMobile){return;}
if(_body.hasClass("side-left-visible")){_body.removeClass("side-left-visible");}else{_body.triggerHandler("hide_modal");_body.addClass("side-left-visible");}
_body.removeClass("side-right-visible");event.preventDefault();event.stopPropagation();});return this;};})(jQuery);(function(jQuery){jQuery.fn.ureport=function(options){var MAX_RECORDS=100000000;var matchedObject=this;var _document=jQuery(document);if(!matchedObject||matchedObject.length===0){return;}
var pathname=window.location.pathname;var pathname_l=pathname.length;var extension=pathname.slice(pathname_l-4,pathname_l);if(extension===".prt"){matchedObject.attr("data-print",1);}
var buttons=jQuery(".report-header > .buttons",matchedObject);var links=jQuery("> a",buttons);var linkOptions=jQuery("> .link-options",buttons);var table=jQuery(".report-table > table",matchedObject);var headers=jQuery("thead > tr > th",table);var loading=jQuery(".report-loading",matchedObject);var location=jQuery(".report-location",matchedObject);var more=jQuery(".report-more",matchedObject);var options=jQuery(".options",matchedObject);var previous=jQuery(".previous",more);var next=jQuery(".next",more);var iconOptions=linkOptions.prev("img");loading.prepend("<div class=\"loader\"></div>");location.html("-");options.prepend("<input type=\"hidden\" name=\"options\" value=\"show\" />");previous.uxdisable();next.uxdisable();options.length===0&&linkOptions.hide()&&iconOptions.hide();setTimeout(function(){var pathname=window.location.pathname;options.attr("method","get");options.attr("action",pathname);links.each(function(index,element){var _element=jQuery(this);var href=_element.attr("href");var search=window.location.search;_element.attr("href",href+search);});});var print=matchedObject.attr("data-print");var count=matchedObject.attr("data-rows")||"30";count=print?MAX_RECORDS:parseInt(count);matchedObject.data("count",count);matchedObject.data("page",0);if(print){var header=jQuery(".header");var footer=jQuery(".footer");var topBar=jQuery(".top-bar");matchedObject.addClass("print");header.remove();footer.remove();topBar.remove();}!print&&headers.click(function(){var element=jQuery(this);var currentOrder=matchedObject.data("order");var reverse=matchedObject.data("reverse")||false;var newOrder=element.attr("data-order");reverse=newOrder!==currentOrder?true:!reverse;matchedObject.data("reverse",reverse);matchedObject.data("order",newOrder);matchedObject.data("dirty",true);headers.removeClass("sorter");element.addClass("sorter");newOrder&&update(matchedObject,options);});matchedObject.length>0&&_document.keydown(onKeyDown=function(event){var report=matchedObject;var keyValue=event.keyCode?event.keyCode:event.charCode?event.charCode:event.which;switch(keyValue){case 39:case 74:increment(report,options);break;case 37:case 75:decrement(report,options);break;default:break;}});matchedObject.bind("destroyed",function(){_document.unbind("keydown",onKeyDown);});linkOptions.click(function(){var element=jQuery(this);var report=element.parents(".report");var options=jQuery(".options",report);options.toggle();});previous.click(function(){var element=jQuery(this);var report=element.parents(".report");decrement(report,options);});next.click(function(){var element=jQuery(this);var report=element.parents(".report");increment(report,options);});var update=function(matchedObject,options){var table=jQuery(".report-table > table",matchedObject);var tableBody=jQuery("tbody",table);var template=jQuery("tr.template",table);var location=jQuery(".report-location",matchedObject);var more=jQuery(".report-more",matchedObject);var previous=jQuery(".previous",more);var next=jQuery(".next",more);var count=matchedObject.data("count");var page=matchedObject.data("page");var order=matchedObject.data("order");var reverse=matchedObject.data("reverse");var dirty=matchedObject.data("dirty");var limit=matchedObject.data("limit");var items=matchedObject.data("items");var sorter=function(first,second){var isNumber=typeof first==="number";if(isNumber){return first[order]-second[order];}else{if(first[order]<second[order]){return-1;}
if(first[order]>second[order]){return 1;}
return 0;}};items=dirty&&order?items.sort(sorter):items;items=dirty&&reverse?items.reverse():items;var offset=page*count;var end=offset+count;var max=items.length<end?items.length:end;var rows=jQuery("tr:not(.template)",tableBody);rows.remove();var _items=[];for(var index=offset;index<max;index++){var current=items[index];var item=template.uxtemplate(current);_items.push(item[0]);}
tableBody.append(_items);if(page===0){previous.uxdisable();}else{previous.uxenable();}
if(page===limit){next.uxdisable();}else{next.uxenable();}
location.html(String(page+1)+" / "+String(limit+1));matchedObject.data("dirty",false);matchedObject.data("items",items);};var print=function(){var print=matchedObject.attr("data-print");print&&window.print();};var limits=function(matchedObject,options){var items=matchedObject.data("items");var count=matchedObject.data("count");var limit=Math.ceil(items.length/count)-1;limit=limit>0?limit:0;matchedObject.data("limit",limit);};var decrement=function(matchedObject,options){var page=matchedObject.data("page");if(page===0){return;}
page--;matchedObject.data("page",page);update(matchedObject,options)};var increment=function(matchedObject,options){var page=matchedObject.data("page");var limit=matchedObject.data("limit");if(page===limit){return;}
page++;matchedObject.data("page",page);update(matchedObject,options)};var load=function(matchedObject,options){var dataSource=jQuery(".report-table > .data-source",matchedObject);matchedObject.addClass("loading");dataSource.uxdataquery({},function(validItems,moreItems){matchedObject.removeClass("loading");matchedObject.data("items",validItems);limits(matchedObject,options);update(matchedObject,options);print(matchedObject,options);});};load(matchedObject,options);};})(jQuery);(function(jQuery){jQuery.utext=function(value){value=value.replace(/{{/g,"");value=value.replace(/}}/g,"");value=value.capitalize(true);return value;};})(jQuery);(function(jQuery){jQuery.utemplate=function(value,noformat){value=value.replace(/{{/g,noformat?"":"<b>");value=value.replace(/}}/g,noformat?"":"</b>");value=value.capitalize(true);return value;};})(jQuery);(function(jQuery){jQuery.fn.uchart=function(method,options){var DRAW_AXIS=true;var DRAW_AUXILIARY_AXIS=false;var DRAW_LABELS=true;var DRAW_LINES=true;var DRAW_LABEL_BOX=false;var LABEL_FONT_NAME="\"Open Sans\", Arial";var LABEL_FONT_SIZE=10;var LABEL_FONT_REAL_SIZE=8;var BASE_COLOR="#4d4d4d";var LABEL_COLOR="#000000";var AXIS_COLOR="#888888";var AUXILIARY_AXIS_COLOR="#aaaaaa";var VALUE_CIRCLE_COLOR="#ffffff";var BACKGROUND_COLOR="#222222";var BACKGROUND_CIRCLE_COLOR="#000000";var BACKGROUND_BOX_COLOR="rgba(0, 0, 0, 1)";var CHART_COLORS=["#77a9df","#ffd67e","#0176ff","#e0cf21","#22b573","#c69c6d","#c14f53","#f0e7d0","#ff78ff"];var VERTICAL_STEPS=7;var HORIZONTAL_STEPS=8;var MAXIMUM_VALUE=999;var MINIMUM_VALUE=0;var VERTICAL_LABEL_WIDTH=36;var HORIZONTAL_LABEL_HEIGHT=20;var LABEL_OFFSET=10;var MARGIN_LEFT=3;var MARGIN_RIGHT=20;var MARGIN_TOP=18;var MARGIN_BOTTOM=4;var BOX_MARGIN_HORIZONTAL=20;var BOX_MARGIN_VERTICAL=20;var BOX_HORIZONTAL_OFFSET=20;var BOX_VERTICAL_OFFSET=20;var UNIT_MAP={1:"K",2:"M",3:"G",4:"T"};var DATA={labels:[],horizontalLabels:[],values:{}}
var defaults={};var method=method?method:"default";var options=options?options:{};var options=jQuery.extend(defaults,options);var matchedObject=this;var initialize=function(){_appendHtml();_registerHandlers();};var _appendHtml=function(){};var _registerHandlers=function(){};var drawAxis=function(matchedObject,options){var context=options["context"];var axisColor=options["axisColor"];var verticalLabelWidth=options["verticalLabelWidth"];var marginLeft=options["marginLeft"];var marginTop=options["marginTop"];var horizontalAxisSize=options["horizontalAxisSize"];var verticalAxisSize=options["verticalAxisSize"];context.save();context.lineWidth=1;context.strokeStyle=axisColor;context.beginPath();context.line(marginLeft+verticalLabelWidth,marginTop-1,marginLeft+verticalLabelWidth,marginTop+verticalAxisSize);context.line(marginLeft+verticalLabelWidth,marginTop+verticalAxisSize,marginLeft+
verticalLabelWidth+horizontalAxisSize+1,marginTop+verticalAxisSize);context.stroke();context.closePath();context.restore();};var drawAuxiliaryAxis=function(matchedObject,options){var context=options["context"];var auxiliaryAxisColor=options["auxiliaryAxisColor"];var horizontalSteps=options["horizontalSteps"];var verticalSteps=options["verticalSteps"];var horizontalLabelHeight=options["horizontalLabelHeight"];var verticalLabelWidth=options["verticalLabelWidth"];var marginLeft=options["marginLeft"];var marginTop=options["marginTop"];var horizontalAxisSize=options["horizontalAxisSize"];var verticalAxisSize=options["verticalAxisSize"];context.save();context.lineWidth=1;context.strokeStyle=auxiliaryAxisColor;context.beginPath();var xPositionIncrement=horizontalAxisSize/(horizontalSteps-1);var currentX=marginLeft+verticalLabelWidth+xPositionIncrement;for(var index=0;index<horizontalSteps-1;index++){context.dashedLine(currentX,marginTop,currentX,marginTop+verticalAxisSize,[2,3]);currentX+=xPositionIncrement;}
var yPositionIncrement=verticalAxisSize/verticalSteps;var currentY=marginTop+verticalAxisSize-yPositionIncrement;for(var index=0;index<verticalSteps-1;index++){context.dashedLine(marginLeft+verticalLabelWidth,currentY,marginLeft+verticalLabelWidth+horizontalAxisSize,currentY,[2,3]);currentY-=yPositionIncrement;}
context.stroke();context.closePath();context.restore();};var drawAxisLabels=function(matchedObject,options){var context=options["context"];var data=options["data"];var labelColor=options["labelColor"];var axisColor=options["axisColor"];var labelFontRealSize=options["labelFontRealSize"];var horizontalAxisSize=options["horizontalAxisSize"];var verticalAxisSize=options["verticalAxisSize"];var horizontalSteps=options["horizontalSteps"];var verticalSteps=options["verticalSteps"];var maximumValue=options["maximumValue"];var minimumValue=options["minimumValue"];var stepValue=options["stepValue"];var verticalLabelWidth=options["verticalLabelWidth"];var labelOffset=options["labelOffset"];var marginLeft=options["marginLeft"];var marginTop=options["marginTop"];var marginBottom=options["marginBottom"];var xPositionIncrement=horizontalAxisSize/(horizontalSteps-1);var currentX=marginLeft+verticalLabelWidth;context.lineWidth=1;context.strokeStyle=axisColor;context.fillStyle=labelColor;for(var index=0;index<horizontalSteps;index++){var horizontalLabel=data.horizontalLabels[index];var textMetrics=context.measureText(horizontalLabel);var textWidth=textMetrics.width;var currentY=marginTop+verticalAxisSize;context.fillText(horizontalLabel,currentX-(textWidth/2),currentY+labelOffset+labelFontRealSize);context.beginPath();context.line(currentX,currentY,currentX,currentY+4);context.stroke();context.closePath();currentX+=xPositionIncrement;}
var yPositionIncrement=verticalAxisSize/verticalSteps;var currentY=marginTop+verticalAxisSize;var currentValue=minimumValue;for(var index=0;index<verticalSteps+1;index++){var valueS=currentValue.toString();var count=valueS.length-1;var unit=Math.floor(count/3);var unitS=unit>=1?UNIT_MAP[unit]:"";var value=currentValue/Math.pow(10,unit*3);valueS=value.toString();valueS=valueS.slice(0,3);valueS=valueS[valueS.length-1]==="."?valueS.slice(0,valueS.length-1):valueS;valueS=valueS+" "+unitS;var textMetrics=context.measureText(valueS);var textWidth=textMetrics.width;var currentX=marginLeft+verticalLabelWidth;context.fillText(valueS,currentX-labelOffset-textWidth,currentY+Math.round(labelFontRealSize/2));context.beginPath();context.line(currentX,currentY,currentX-4,currentY);context.stroke();context.closePath();currentY-=yPositionIncrement;currentValue+=stepValue;}};var drawLines=function(matchedObject,options){var context=options["context"];var data=options["data"];var valueCircleColor=options["valueCircleColor"];var backgroundCircleColor=options["backgroundCircleColor"];var chartColors=options["chartColors"];var maximumValue=options["maximumValue"];var minimumValue=options["minimumValue"];var horizontalSteps=options["horizontalSteps"];var verticalSteps=options["verticalSteps"];var verticalLabelWidth=options["verticalLabelWidth"];var marginLeft=options["marginLeft"];var marginTop=options["marginTop"];var horizontalAxisSize=options["horizontalAxisSize"];var verticalAxisSize=options["verticalAxisSize"];var dataValues=data["values"];var chartColorsLength=chartColors.length;context.save();context.lineWidth=2;var xPositionIncrement=horizontalAxisSize/(horizontalSteps-1);var yPositionIncrement=verticalAxisSize/verticalSteps;var valuesIndex=0;for(var key in dataValues){var currentValues=dataValues[key];var colorIndex=valuesIndex%chartColorsLength;var currentColor=chartColors[colorIndex];context.strokeStyle=currentColor
context.beginPath()
var initialValue=currentValues[0];var currentX=marginLeft+verticalLabelWidth;var deltaValue=initialValue-minimumValue;var valueSteps=(deltaValue*verticalSteps)/maximumValue;var positionValue=valueSteps*yPositionIncrement;var currentY=marginTop+verticalAxisSize-positionValue;var initialX=currentX;var initialY=currentY;context.moveTo(currentX,currentY);currentX+=xPositionIncrement;for(var index=1;index<horizontalSteps;index++){var currentValue=currentValues[index];var deltaValue=currentValue-minimumValue;var valueSteps=((deltaValue*verticalSteps)/maximumValue);var positionValue=valueSteps*yPositionIncrement;var currentY=marginTop+verticalAxisSize-positionValue;context.lineTo(currentX,currentY);currentX+=xPositionIncrement;}
context.stroke();context.closePath();var currentX=marginLeft+verticalLabelWidth;for(var index=0;index<horizontalSteps;index++){var currentValue=currentValues[index];var deltaValue=currentValue-minimumValue;var valueSteps=((deltaValue*verticalSteps)/maximumValue);var positionValue=valueSteps*yPositionIncrement;var currentY=marginTop+verticalAxisSize-positionValue;context.fillStyle=valueCircleColor;context.beginPath();context.arc(currentX,currentY,5,0,Math.PI*2,true);context.fill();context.closePath();context.fillStyle=currentColor;context.beginPath();context.arc(currentX,currentY,4,0,Math.PI*2,true);context.fill();context.closePath();context.fillStyle=valueCircleColor;context.beginPath();context.arc(currentX,currentY,2,0,Math.PI*2,true);context.fill();context.closePath();currentX+=xPositionIncrement;}
valuesIndex++;}
context.restore();};var initializeContext=function(matchedObject,options){var context=options["context"];var labelFontName=options["labelFontName"];var labelFontSize=options["labelFontSize"];context.fillStyle="#4d4d4d";context.strokeStyle="#4d4d4d";context.lineWidth=1;context.font=labelFontSize+"px "+labelFontName;};var populateOptions=function(matchedObject,options){var chartWidth=options["width"];var chartHeight=options["height"];var drawAxis=options["drawAxis"]?options["drawAxis"]:DRAW_AXIS;var drawAuxiliaryAxis=options["drawAuxiliaryAxis"]?options["drawAuxiliaryAxis"]:DRAW_AUXILIARY_AXIS;var drawLabels=options["drawLabels"]?options["drawLabels"]:DRAW_LABELS;var drawLines=options["drawLines"]?options["drawLines"]:DRAW_LINES;var drawLabelBox=options["drawLabelBox"]?options["drawLabelBox"]:DRAW_LABEL_BOX;var labelFontName=options["labelFontName"]?options["labelFontName"]:LABEL_FONT_NAME;var labelFontSize=options["labelFontSize"]?options["labelFontSize"]:LABEL_FONT_SIZE;var labelFontRealSize=options["labelFontRealSize"]?options["labelFontRealSize"]:LABEL_FONT_REAL_SIZE;var baseColor=options["baseColor"]?options["baseColor"]:BASE_COLOR;var labelColor=options["labelColor"]?options["labelColor"]:LABEL_COLOR;var axisColor=options["axisColor"]?options["axisColor"]:AXIS_COLOR;var auxiliaryAxisColor=options["auxiliaryAxisColor"]?options["auxiliaryAxisColor"]:AUXILIARY_AXIS_COLOR;var valueCircleColor=options["valueCircleColor"]?options["valueCircleColor"]:VALUE_CIRCLE_COLOR;var backgroundCircleColor=options["backgroundCircleColor"]?options["backgroundCircleColor"]:BACKGROUND_CIRCLE_COLOR;var backgroundBoxColor=options["backgroundBoxColor"]?options["backgroundBoxColor"]:BACKGROUND_BOX_COLOR;var chartColors=options["chartColors"]?options["chartColors"]:CHART_COLORS;var verticalSteps=options["verticalSteps"]?options["verticalSteps"]:VERTICAL_STEPS;var horizontalSteps=options["horizontalSteps"]?options["horizontalSteps"]:HORIZONTAL_STEPS;var maximumValue=options["maximumValue"]?Math.ceil(options["maximumValue"]/verticalSteps)*verticalSteps:MAXIMUM_VALUE;var minimumValue=options["minimumValue"]?options["minimumValue"]:MINIMUM_VALUE;var rangeValue=maximumValue-minimumValue;var stepValue=Math.round(rangeValue/verticalSteps);var horizontalLabelHeight=options["horizontalLabelHeight"]?options["horizontalLabelHeight"]:HORIZONTAL_LABEL_HEIGHT;var verticalLabelWidth=options["verticalLabelWidth"]?options["verticalLabelWidth"]:VERTICAL_LABEL_WIDTH;var labelOffset=options["labelOffset"]?options["labelOffset"]:LABEL_OFFSET;var marginLeft=options["marginLeft"]?options["marginLeft"]:MARGIN_LEFT;var marginRight=options["marginRight"]?options["marginRight"]:MARGIN_RIGHT;var horizontalMargin=marginLeft+marginRight+verticalLabelWidth;var marginTop=options["marginTop"]?options["marginTop"]:MARGIN_TOP;var marginBottom=options["marginBottom"]?options["marginBottom"]:MARGIN_BOTTOM;var verticalMargin=marginTop+marginBottom+horizontalLabelHeight;var boxMarginHorizontal=options["boxMarginHorizontal"]?options["boxMarginHorizontal"]:BOX_MARGIN_HORIZONTAL;var boxMarginVertical=options["boxMarginVertical"]?options["boxMarginVertical"]:BOX_MARGIN_VERTICAL;var boxHorizontalOffset=options["boxHorizontalOffset"]?options["boxHorizontalOffset"]:BOX_HORIZONTAL_OFFSET;var boxVerticalOffset=options["boxVerticalOffset"]?options["boxVerticalOffset"]:BOX_VERTICAL_OFFSET;var horizontalAxisSize=chartWidth-horizontalMargin;var verticalAxisSize=chartHeight-verticalMargin;options["drawAxis"]=drawAxis;options["drawAuxiliaryAxis"]=drawAuxiliaryAxis;options["drawLabels"]=drawLabels;options["drawLines"]=drawLines;options["drawLabelBox"]=drawLabelBox;options["labelFontName"]=labelFontName;options["labelFontSize"]=labelFontSize;options["labelFontRealSize"]=labelFontRealSize;options["baseColor"]=baseColor;options["labelColor"]=labelColor;options["axisColor"]=axisColor;options["auxiliaryAxisColor"]=auxiliaryAxisColor;options["valueCircleColor"]=valueCircleColor;options["backgroundCircleColor"]=backgroundCircleColor;options["backgroundBoxColor"]=backgroundBoxColor;options["chartColors"]=chartColors;options["verticalSteps"]=verticalSteps;options["horizontalSteps"]=horizontalSteps;options["maximumValue"]=maximumValue;options["minimumValue"]=minimumValue;options["rangeValue"]=rangeValue;options["stepValue"]=stepValue;options["horizontalLabelHeight"]=horizontalLabelHeight;options["verticalLabelWidth"]=verticalLabelWidth;options["labelOffset"]=labelOffset;options["marginLeft"]=marginLeft;options["marginRight"]=marginRight;options["horizontalMargin"]=horizontalMargin;options["marginTop"]=marginTop;options["marginBottom"]=marginBottom;options["verticalMargin"]=verticalMargin;options["boxMarginHorizontal"]=boxMarginHorizontal;options["boxMarginVertical"]=boxMarginVertical;options["boxHorizontalOffset"]=boxHorizontalOffset;options["boxVerticalOffset"]=boxVerticalOffset;options["horizontalAxisSize"]=horizontalAxisSize;options["verticalAxisSize"]=verticalAxisSize;};var drawLabelBox=function(matchedObject,options){var context=options["context"];var data=options["data"];var labelFontRealSize=options["labelFontRealSize"];var backgroundBoxColor=options["backgroundBoxColor"];var chartColors=options["chartColors"];var auxiliaryAxisColor=options["auxiliaryAxisColor"];var verticalLabelWidth=options["verticalLabelWidth"];var marginLeft=options["marginLeft"];var marginTop=options["marginTop"];var boxMarginHorizontal=options["boxMarginHorizontal"];var boxMarginVertical=options["boxMarginVertical"];var boxHorizontalOffset=options["boxHorizontalOffset"];var boxVerticalOffset=options["boxVerticalOffset"];var horizontalAxisSize=options["horizontalAxisSize"];var verticalAxisSize=options["verticalAxisSize"];var dataValues=data["values"];var chartColorsLength=chartColors.length;var valueCount=0;var largestWidth=0;for(var key in dataValues){var textMetrics=context.measureText(key);var textWidth=textMetrics.width;largestWidth=textWidth>largestWidth?textWidth:largestWidth;valueCount++;}
var lineHeight=labelFontRealSize+boxMarginVertical;var boxWidth=largestWidth+(2*boxMarginHorizontal)+46;var boxHeight=valueCount*lineHeight+boxMarginVertical;var boxX=marginLeft+verticalLabelWidth+horizontalAxisSize-boxWidth-
boxHorizontalOffset;var boxY=marginTop+boxVerticalOffset;context.fillStyle=backgroundBoxColor;context.beginPath()
context.roundRectangle(boxX,boxY,boxWidth,boxHeight,6);context.stroke();context.fill();context.closePath();var currentX=boxX+boxMarginHorizontal+40;var currentY=boxY+lineHeight;var valuesIndex=0;for(var key in dataValues){var colorIndex=valuesIndex%chartColorsLength;var currentColor=chartColors[colorIndex];context.strokeStyle=currentColor
context.fillStyle="#ffffff";context.fillText(key,currentX,currentY);context.fillStyle=currentColor;context.beginPath();context.arc(currentX-24,currentY-10,10,0,Math.PI*2,true);context.fill();context.closePath();currentY+=lineHeight;valuesIndex++;}};var processData=function(matchedObject,options){var data=options["data"]?options["data"]:DATA;var dataValues=data["values"];var maximumValue=0;for(var key in dataValues){var currentValues=dataValues[key]
var currentValuesLength=currentValues.length;for(var index=0;index<currentValuesLength;index++){var currentValue=currentValues[index];if(currentValue>maximumValue){maximumValue=currentValue;}}}
options["data"]=data;options["maximumValue"]=maximumValue;};var draw=function(){var chart=matchedObject;var _window=jQuery(window);var _body=jQuery("body");var chartElement=chart.get(0);if(!chartElement){return;}
matchedObject.length>0&&!matchedObject.data("on_resize")&&_window.bind("resize",onResize=function(){var sizes={width:_window.width(),height:_window.height()};setTimeout(function(){if(_window.width()!==sizes.width){return;}
if(_window.height()!==sizes.height){return;}
draw();},150);});matchedObject.bind("destroyed",function(){var element=jQuery(this);var onResize=matchedObject.data("on_resize");_window.unbind("resize",onResize);matchedObject.data("on_resize",null);});matchedObject.data("on_resize",onResize);var chartWidth=matchedObject.width();var chartHeight=matchedObject.height();var context=chartElement.getContext("2d");var isRetina=_body.hasClass("retina-s");if(isRetina){chartElement.width=chartWidth*2;chartElement.height=chartHeight*2;context.scale(2,2)}
context.clearRect(0,0,chartWidth,chartHeight);options["chart"]=chart;options["context"]=context;options["width"]=chartWidth;options["height"]=chartHeight;processData(matchedObject,options);populateOptions(matchedObject,options);var _drawAxis=options["drawAxis"];var _drawAuxiliaryAxis=options["drawAuxiliaryAxis"];var _drawLabels=options["drawLabels"];var _drawLines=options["drawLines"];var _drawLabelBox=options["drawLabelBox"];initializeContext(matchedObject,options);_drawAuxiliaryAxis&&drawAuxiliaryAxis(matchedObject,options);_drawAxis&&drawAxis(matchedObject,options);_drawLabels&&drawAxisLabels(matchedObject,options);_drawLines&&drawLines(matchedObject,options);_drawLabelBox&&drawLabelBox(matchedObject,options);};switch(method){case"draw":draw();break;case"default":initialize();break;}
return this;};})(jQuery);jQuery(document).ready(function(){var _body=jQuery("body");_body.uxapply();_body.uapply();_body.bind("applied",function(event,base){base.uapply();});});
